---
title: "Iterative Solutions for Debye Huckel Equation"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Introduction

If the activity coefficients or ionic strength of a solute in solution is known, the other value can be solved for. However, if neither are known, iterative solutions must be employed to determine both the activity coefficients and the ionic strength. 
First, the activity coefficients are assumed to be 1. The ionic strength is then calculated based on these values and the concentration of the solutes in solution. Secondly, the ionic strength and relevant coefficients can be used in the Debye-Huckel equation to solve for the activity coefficients. These coefficients can then be used to repeat Step 1. The cycle is performed until the values obtained from two successive cycles produce similar answers. 
We plan on creating a database with the relevant and necessary constants required for determination of ionic strength and the activity coefficients for a variety of species, such as hydrated radius, solubility constants, etc. We plan on writing a program to access these constants and utilizing them in the equations for ionic strength and Debye-Huckel. We plan on writing this program in RStudio, utilizing python blocks. The primary resource utilized thus far for the necessary equations in this project is the eight edition of the "Quantitative Chemical Analysis" textbook by Daniel C. Harris. 

## Solving for Ionic Strength - Brynne Wilson

To use the Debye Huckel equation, the ionic strength ($\mu$) must be known. As such, I will be using the following equation for ionic strength along with the concentration of the solutes and the charge of the ions (Equation 1). I will also be working on writing the code necessary to access the constants and coefficients from the database created by Valerie required in the ionic strength equation (charge and concentration)  


$\mu$= $\frac{1}{2}\sum_{1}^{n} C_{i}Z_{i}$		                                                            	                                (1)  

For example, if given 0.1M Na+ and 0.2M K+, $\mu$ will be 

```{r} 

1/2*((0.1)*(1)^2+(0.2)*(1)^2) 

``` 

## Solving for Activity Coefficients-Jenna Eubanks-Gray

I will be using the $\mu$ calculated in the previous section, the hydrated radii from the database, and the charge of the ion in the Debye-Huckel equation shown in Equation (2). 

log($\gamma$)=$\frac{-0.51z^2\sqrt{\alpha}}{1+0.33\alpha\sqrt{\gamma}}$    (2)

The activity coefficient will then be used to calculate the ionic strength. Step 1 and Step 2 will continue until the answers produced from Step 2 are the same to within 10^(-6) of the last step. I will also be designing the code to read in the needed values from the database. An example problem has been conducted below to demonstrate how the equation calculations will appear.  

```{r}
10^(-0.51*(1^2)*sqrt(1.3*10^(-5)))/(1+0.33*(25)*(1.3*10^(-5)))
```
## creating a database 

In order to solve for both activity coefficients and for ionic strength, I will create a dictionary that will hold the constants for Ksp, $\mu$, ionic charge, and  $\alpha$, for ions in solution. These constants will be pulled from the dictionary to be used in equations 1 and 2. 

a csv file will be used to import the data into the code. An example of the data is shown bellow. 

Ion    charge   $\alpha$     
H+       +1        900      

```{r Table1}
Table1<- read.csv("Computingproject.csv", header=TRUE)
print(Table1)
```

```{python}
import math 
import pandas as pd 
Difference = 1 
Table1 = pd.read_csv("Computingproject.csv",
                 index_col=0)
##print(Table1["CHARGE"]["Li"])                 
#print(Table1.loc["Ce4",:])
#the above line can be uncommented to find both charge and alpha for each ion

ion1 = input("Enter name of ion in solution: ") 
ion2 = input("Enter name of second ion in solution:") 
concentration = float(input("Enter concentration of solution:")) 
compound = input("Enter the chemical formula of the compound in solution") 

##concentration2 = float(input("Enter concentration of second solution:")

print(ion1) 
print(ion2) 
charge1 = Table1["CHARGE"][ion1] 
charge2 = Table1["CHARGE"][ion2] 
alpha1 = Table1["$ALPHA$"][ion1] 
alpha2 = Table1["$ALPHA$"][ion2] 
ksp = Table1["KSP"][compound] 
activitycoefficient1 = 1
activitycoefficient2 = 1
activity1 = math.sqrt(ksp/(activitycoefficient1*activitycoefficient2))
activity2 = math.sqrt(ksp/(activitycoefficient1*activitycoefficient2))
mu = 0.5*(concentration*(charge1)**2 + concentration*(charge2)**2)

sqrtmu = math.sqrt(mu) 
activitycoefficienta = 10**(-0.51*(charge1**2)*(sqrtmu))/(1+alpha1*(sqrtmu)/305)
activitycoefficientb = 10**(-0.51*(charge2**2)*(sqrtmu))/(1+alpha2*(sqrtmu)/305)

while Difference>0.00001:
  #Step 1: Brynne
  activitya = math.sqrt(ksp/(activitycoefficienta*activitycoefficientb))
  activityb = math.sqrt(ksp/(activitycoefficienta*activitycoefficientb))
  muA = 1/2*(activitya*(charge1)**2 + activityb*(charge2)**2)
    
   #Step 2: Jenna   
   def Step2():  
     sqrtmuA = math.sqrt(muA) 
     activitycoefficientc = 10**(-0.51*(charge1**2)*(sqrtmuA))/(1+alpha1*(sqrtmuA)/radius1) 
     activitycoefficientd = 10**(-0.51*(charge2**2)*(sqrtmuA))/(1+alpha2*(sqrtmuA)/radius2) 
     
    #Step 3: Brynne 
  activityc = math.sqrt(ksp/(activitycoefficientc*activitycoefficientd))
  activityd = math.sqrt(ksp/(activitycoefficientc*activitycoefficientd))
  muB = 1/2*(activityc*(charge1)**2 + activityd*(charge2)**2)
      

     
    #Step 4: Jenna  
    def Step4():   
      sqrtmuB = math.sqrt(muB) 
      activitycoefficienta = 10**(-0.51*(charge1**2)*(sqrtmuA))/(1+alpha1*(sqrtmuA)/radius1) 
      activitycoefficientb = 10**(-0.51*(charge2**2)*(sqrtmuA))/(1+alpha2*(sqrtmuA)/radius2) 
    Step4() 
      
    Difference = activitycoefficientb - activitycoefficientd   
    
print(activitycoefficientc)
print(activitycoefficientd)
```
